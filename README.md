# LoopOfHenle

Contribution to the European Health Hackathon 2022 Challenge 6 "Are you kidneying" https://hackhealth.eu/ . Collaborative work done by Roman Dusek, Francis Chemorion and Benjamin Senst.

Progress & ToDo GoogleDoc https://docs.google.com/document/d/1tdbptVnlwAC6p1nt4oPbzKTXhUuPqZB65h2o9GeFpvU

## Key findings

Different XGBoost models have been created as a result of the hackathon project. The model identified relevant features to different the presence/upcoming of chronic kidney disease. XGBoost is an open-source implementation of the gradient boosted trees algorithm. It is a type of supervised learning algorithm.

### XGBoost Model Interpretation

![image](https://user-images.githubusercontent.com/8211411/204102327-f222d19e-b6aa-4c99-8eb0-770912e9a600.png)

Blue colored data points represent a low feature value (i.e. decreased hemoglobine (Hb), which is Anemia as can be found as a consequence of Chronic Kidney Disease (CKD)) whereas red data points stand for increased feature value (i.e. inceased hemoglobine). Having a closer look on the hemoglobine feature one can observe that the red dots (i.e. higher Hb) are located left to the midline thus speaking against the presence/development of CKD. In contrast low hemoglobine as illustrated by blue points can be found to the right of the midline indicating the presence/development of CKD. The features further down the list have less impact on the model output as they are aligned midline.

![image](https://user-images.githubusercontent.com/8211411/204102346-a140b188-1197-449e-8b91-73e1b116065e.png)

The diagram showing the mean SHAP values illustrate the features with the most profound impact on the model output magnitude regardless of the direction the show (i.e. speaking for CKD or for non-CKD case). The diagram suggests features such as serum kreatinin, diffeence in absolute and relative granulocyte count, difference in thrombocyte level, hemoglobine and hematocrite, lymphocytes, neutrophiles, glomerular filtration rate, urine specific weight and erythrocyte anisocytosis.

The dataset reflects current clinical practice. Thus more frequent lab tests are overrepresented and might hide more rare features among other lab tests. From descriptive data analysis we propose the following features as candidates for further investigation which are not clinical routine for detecting kidney tissue damage:

'''
s_a-b-2GPI IgG  s_a-kardiol.IgG  s_a-PS IgM  s_anti PI IgM  s_a-b-2GPI IgM  s_a-kardiol.IgM  s_total IgE s_Total IgE  DNA-A HLA-A (DNA) (Pt; HLA genotyp [-] PCR) HLA-A  s_anti-TG Anti tyreoglobulin  S_FSH  s_anti PI IgG  anti TETANUS IgG  U_albumin/kreat. V_Index MIAL/U_KRE ACR - albumin/kreatinin v moči U-alb/U-krea ACR = U-albumin / U-kreatinin ACR (Albumin/kreatinin) Albumin/Kreatinin ACR ACR- albumin/kreatinin ratio v moči Alb/krea v moči U-albumin/kreatinin (ACR) ACR- albumin/kreatinin v moči Albumin/kreatinin  S_LH  s_b-2-mikroglob.  U_válce hyalinní U-válce nepatologické  s_a-MPO CIA s_a-MPO ELISA  U_krev Hemoglobin Krev Krev - hemoglobin U_krev (M chem.) Krev-hemoglobin chemicky moč KREV krev  CVVH-vápník ion.  U_albumin ranní U_Mikroalbumin Albumin v moči Mikroalbuminurie Albuminurie Mikroalbumin U-albumin, ranní moč  p_DRVVT_pacient  U_válce patolog. U_válce patol. UD  U_válce patol. UF  s_lipáza Lipáza Lipasa  s_anti-TPO  s_CA 125  U_protein/kreat.  ROMA  s_HBsAg kvantita  s_anti-tTG IgG  s_ferritin Ferritin  U_protein ranní  p_DRVVT-sc1:1-RI  s_parathormon s_PTH(1-84)  Urea S_Urea - močovina Urea - močovina UREA  p_DRVVT_ratio  U_erytrocyty Hamburger-ery Erytrocyty erytrocyty U_ery (M sed.) U-erytrocyty Hamburgerův sediment - ery  p_aPTT-LA_pacien  p_aPTT-LA_ratio  s_HE4  s_kreatinin kreatinin S-kreatinin  S_Prolaktin  U_válce hyalinní UF  s_C peptid  p_aPTT-konf.hex.  s_CMV IgM  s_propeptid prokolagenu 1 s_P1NP  x_Frakční exkrece vody Frakč.exkreceH2O  s_CA 125  p_aPTT_scr/konf  B_CD16 + 56  Kreatinin S_Kreatinin KREA  s_urea Urea urea S_Urea S-urea  p_DRVVT_pacient  p_kreatinin P-kreatinin  Erytropoietin Erytrocyty  p_aPTT-LA1:1-RI  s_EBNA IgG  p_DRVVT scr/konf  s_EBV VCA IgG  p_DRVVT_scr_1:1  s_PSA  p_BNP  p_Aldosteron  s_b-CrossLaps  s_B12 aktivní  p_urea Urea P-urea  s_ferritin Ferritin S_Ferritin  s_Herpes IgG  U_albuminurie  p_LDH LDH  p_DDi_kvantit.  s_Kortizol Kortisol (dopoledne)  dU_protein celk. Bílkovina odpad U_odpady protein./24h Proteinurie odpad  s_FSH  p_aPTT-LA_1:1  s_CA 15-3  dU_albumin Mikroalbuminurie/den  s_cystatin C  U_protein celk. Bílkovina v moči  p_Aldosteron  B_Tyče Neutrofilní tyče Tyč-mikr.  B_NK abs.počet  s_B12 aktivní  s_parathormon Parathormon PTH  s_ferritin  s_CA 15-3  s_prolaktin  s_ceruloplasmin  s_ASCA IgG  B_leukocyty  Kappa+CD19+ Buňky CD19+/kappa+  U_erytrocyty UD U_Erytrocyty elementy Erytrocyty mikroskopicky  B_CD19  U_albumin sběr U-mikroalb. U_Albumin v ranní moči MALB Albumin  p_PT_ratio PT-ratio Protrombinový test - ratio PT - ratio PT (Quick) - ratio P_Protrombinový test - ratio PT - Ratio PT (ratio) PT-poměr PT- ratio  s_fPSA  p_PT_pacient  p_AST AST P-AST  objem sbír Moč sběr - objem objem moče - sběr Moč neupravená Objem Množství moče mnozstvi 1 Moč neupravená - objem moč-sběr  B_CD16 + 56  B_Sedimentace/1h FW / 1h FW za 1 h.  p_fosfor Fosfor  p_amoniak  B_Segmenty Neutrofilní segmenty Segment-mikr.  s_EBV EA IgG  B_poměr CD4/CD8  s_a-HBs  p_aPTTnecit_rat  s_fPSA  p_homocystein  s_AMS Amyláza Alfa-amylasa v séru  p_ALT ALT P-ALT  p_DRVVTkonf_rati  p_Digoxin  B_Metamyelocyty Metamyelocyty  CD20 Lymfocyty CD20+  p_glukóza (NaF)  s_Chl.pn.IgM  p_DRVVTkonf_paci  p_PT_INR INR PT INR Protrombinový test - INR Quick test Protrombinový test - INR (PT) Quick INR PT (Quick) - INR PT - INR P_Protrombinový test - INR Quick PT Quick Protromb. test (Quick): INR_ Protrombinový test (Quick) PT (antikoag. léčba) INR. PT- INR  s_propeptid prokolagenu 1  s_a1 antitrypsin  p_Faktor XII  B_takrolimus  s_Kortizol S_Kortizol  B_RTC mladé  p_PT_%  s_EBV VCA IgM  B_ASPIRIN_VERIFY p_ASPIRIN_VERIFY  s_bilirubin přím  p_prokalcitonin s_prokalcitonin  B_Lymfocyty_abs Lymfocyty ap 5P Lymfocyty abs. Lymfocyty Abs  U_sodík  U_kreatinin  CD19 Lymfocyty CD19+  B_Lymfocyty Lymfocyty % 5P Lymfocyty  p_železo Železo  s_CIK vazbou C1q  s_anti-tTG IgA  1.25(OH)D  dU_kreatinin  U_chloridy  U_epitelie jiné  p_Gentamicin  p_GGT GGT  p_transfer. sat.  s_CA 72-4  S-triacylglyc. S_Triacylglyceroly  U_kreatinin ran.  s_Chl.pn.IgG  s_ApoC-III  s_bilirubin celk  S-PSA PSA PSA celkový  U_leukocyty Hamburger-leuko U_Leu (M sed.) U-leukocyty Hamburgerův sediment - leuko Leukocyty  p_lipáza  Vitamin D Total Vitamín D Vitamin D 25-OH vitamin D total B_Vitamin D total (25-OH) S-25-OH-vitaminD 25-hydroxyvitamin D Vitamin D total  p_NT-proBNP  DNA-B HLA-B (DNA) (Pt; HLA genotyp [-] PCR) HLA-B  p_Faktor VIII  s_IgM  s_anti-TSH rec. TRAK (anti TSH recep.)  s_a-HBs  U_kys.močová U-kyselina močová  B_CD4 abs.počet  U_fosfor U-fosfor (P)  s_IgG2  p_Digoxin  U_válce hyalinní UD Válce hyalinní  Normetanefrin  B_CD3 abs.počet  DHEAS  p_bilirubin celk  B_CD8 abs.počet  GFR-MDRD-3P  f_hemoglobin f_hemogl. korig. f_Hemoglobin korigovaný  U_draslík  s_hs-Troponin T  s_IgG3  s_LH  dU_vápník celk. dU-vápník/24h  GFR-MDRD-1P MDRD 1P GFR-MDRD eGFR(MDRD-1P)  p_AMS Amyláza  GFR-CYSTC-K  GFR-KRKOR Clearance/1.73 Clearance kreatininu / 1.73m2 Glom.filtr.korig  U_urea  s_AMS pankreat.  U_vápník celk. U-vápník (Ca)  s_COVID-19 IgG CLIA s_COVID-19 IgG  dr_bilirub. celk  p_AMS pankreat.  GFR-KR Clearance kreat. Clearance kreatininu (GF) Glom.filtrace  GFR-CYSTC  B_Lymfocyty Lymfocyty Lymfocyty (relativní počet) Lymfocyt-mikr.  p_bilirubin přím  B_NRBC_abs.počet  dU_urea  s_a-gliadin IgA Gliadin IgA  s_prokalcitonin  C PEPTID C-peptid  s_CMV IgM  sTfR/F  s_Dermat.farinae  NEESTER. MK  CKD-EPI eGF (CKD-EPI) GF CKD-EPI CKD-EPI pro kreatinin Výp.GFR dle CKD-EPI eGFR (CKD-EPI) GF odhad dle CKD EPI Glomerul. filtrace (CKD-EPI) Odhad GF dle CKD-EPI eGFR-CKD-EPI GF dle CKD-EPI  U_OSM okamžitá  s_Degradace histaminu  U_OSM sběr  s_anti-virus hepatitidy E IgM  GFR-KRKOR  GFR-MDRD-1P MDRD S_Odhad GF dle CKD-EPI Odhad GF dle CKD-EPI  s_a-HBs  B_CD19 abs.počet  S-free PSA  s_ASLO ASLO Antistreptolyzin O S_ASLO  s_a-PS IgG  s_Borrelia IgG  GFR-KR  dU-kortizol volný/24 h U-kortisol volny  s_ANA IF ANA IgG  NRBCau technická B_NRBCaut/100Leu NORMOBLASTY aut. B_NRBC – relativně  p_CK  GFR-MDRD-3P  p_CMV qRT PCR  s_a-dsDNA CIA s_a-dsDNA ELISA  s_Herpes IgM  s_b-CrossLaps B_Beta-Crosslaps beta CrossLaps  p_Apixaban  s_AFP  p_prokalcitonin  s_Chl.sp.IgA Anti CHLAMYDIE LPS IgA ELISA  s_Mycop.pneu.IgM  s_CA 72-4  s_a-gliadin IgG Gliadin IgG  p_bilirubin přím  s_anti-tTG IgG  s_CIK vazbou C1q  U_epitelie přechodné UD U-epitelie kulaté  p_Renin  dr_bilirub. přím  P-myoglobin  s_Chl.sp.IgM Anti CHLAMYDIE LPS IgM ELISA  f_hemoglobin  v_3-OH-butyrát  s_lipoprotein(a)  s_a-MPO CIA  p_ACTH  s_a-dsDNA CIA  s_ASCA IgA  CD19 Buňky CD19+  p_Renin  s_testosteron  s_GX1-trávy rané  s_C peptid  s_GX4-trávy poz.  s_WX1-plevely s.  s_a-PR3 CIA s_a-PR3 ELISA  s_total IgE s_Total IgE  GAD M  s_anti-tTG IgA  s_TX10-stromy s.  s_a-PR3 CIA  s_pes  U_glukóza Glukóza  s_Dermatoph.pter  s_TX6-stromy sm.  s_kočka  s_TX10-stromy s.  s_rBetv2 profil. s_rBet v2  PRADTT Protilátky Anti-HLA (panel 30)* (S; num. podíl [%] test cytotoxický) PRA s DTT  PRA Protilátky Anti-HLA (panel 30)* (S; num. podíl [%] *) PRA  U_hlen U_hlen UD Hlen U_Hlen HLEN  U_hlen UF Hlen v sedimentu moče Hlen Hlenová vlákna U_Hlen  s_a-nukleosomy  U_shluky leukocytů UF Leukocyty U_Leukocyty ULEUK  U_bakterie U_bakterie UF Bakterie U_Bakterie BACT U_bakterie (M sed.)
'''

## Further Resources as a result of the Friday Warm-up

|URL|Description|
|---|---|
| https://pubmed.ncbi.nlm.nih.gov/35003242/ | Implementation of Machine Learning Models for the Prevention of Kidney Diseases (CKD) or Their Derivatives |
| https://pubmed.ncbi.nlm.nih.gov/35915457/ | Machine learning algorithms' accuracy in predicting kidney disease progression: a systematic review and meta-analysis | 
| https://pubmed.ncbi.nlm.nih.gov/32932685/ | Optimized Identification of Advanced Chronic Kidney Disease and Absence of Kidney Disease by Combining Different Electronic Health Data Resources and by Applying Machine Learning Strategies |
| https://pubmed.ncbi.nlm.nih.gov/33850243/ | Medical records-based chronic kidney disease phenotype for clinical care and "big data" observational and genetic studies | https://pubmed.ncbi.nlm.nih.gov/32424281/ | Integrated multi-omics approaches to improve classification of chronic kidney disease | 
| https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8048707/ | Machine learning, the kidney, and genotype-phenotype analysis |
| https://youtu.be/XOeoisg85pA | Chronic Kidney Disease Prediction using Machine learning |
| https://youtu.be/a0NlmSIYiEY | Chronic Kidney Disease prediction using Machine Learning |
| https://www.youtube.com/watch?v=lD63ZzmgQmg | https://github.com/pg815/Kidney_Cancer_Prediction_Using_Machine_Learning |
| https://www.youtube.com/watch?v=MUkn5FYnSac | Survey on Prediction of Chronic Kidney Disease Using Data Mining Classification Techniques and Feature Selection.International Conference on Advances in Computer Science, Engineering and Technology – ICACSET’18 |
| https://www.ijert.org/chronic-kidney-disease-prediction-using-machine-learning |
| https://www.youtube.com/watch?v=bgDdNM-D-TU | A Machine Learning Methodology for Diagnosing Chronic Kidney Disease | Python IEEE Project |
| https://www.youtube.com/watch?v=idXF9JFBjZY | Using machine learning for the early prediction of chronic kidney disease |
| https://www.youtube.com/watch?v=uxMvHSUOZzc | Chronic Kidney Disease Prediction Using Python & Machine Learning |
| https://www.youtube.com/watch?v=4C3dJmXnpkE | A Machine Learning Methodology for Diagnosing Chronic Kidney Disease: A Review |
| https://archive.ics.uci.edu/ml/datasets/chronic_kidney_disease |

### On Time series & Machine Learning

* https://jakevdp.github.io/PythonDataScienceHandbook/03.11-working-with-time-series.html
* https://www.machinelearningplus.com/time-series/time-series-analysis-python/
* https://builtin.com/data-science/time-series-python
* https://machinelearningmastery.com/a-guide-to-obtaining-time-series-datasets-in-python/
* https://neptune.ai/blog/time-series-prediction-vs-machine-learning
* https://www.tensorflow.org/tutorials/structured_data/time_series
* https://github.com/yzhao062/Pyod Python Outlier Detection (PyOD)
